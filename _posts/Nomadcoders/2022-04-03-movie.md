---
layout: single
title: "[React] ReactJS로 영화 웹 서비스 만들기"

categories:
  - Web

tags:
  - React
  - nomadcoders

author_profile: true # 왼쪽부분 프로필을 띄울건지

header:
  overlay_image: https://images.unsplash.com/photo-1501785888041-af3ef285b470?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1350&q=80
  overlay_filter: 0.5 # 투명도

# table of contents
toc: true # 오른쪽 부분에 목차를 자동 생성해준다.
toc_label: " table of content" # toc 이름 설정
toc_icon: "bars" # 아이콘 설정
toc_sticky: true # 마우스 스크롤과 함께 내려갈 것인지 설정
---

보통 요즘은 fetch해서 then하는 것보다 좀 더 보편적으로 async-await을 사용한다.

```jsx
import React, { useState, useEffect } from "react";

function App() {
  const [loading, setLoading] = useState(true);
  const [movies, setMovies] = useState([]);

  // useEffect(() => {
  //   fetch(
  //     `https://yts.mx/api/v2/list_movies.json?minimum_rating=9&sort_by=year`
  //   )
  //     .then((response) => response.json())
  //     .then((json) => {
  //       setMovies(json.data.movies);
  //       setLoading(false);
  //     });
  // }, []);

  const getMovies = async () => {
    const response = await fetch(
      `https://yts.mx/api/v2/list_movies.json?minimum_rating=9&sort_by=year`
    );
    const json = await response.json();
    setMovies(json.data.movies);
    setLoading(false);
  };

  useEffect(() => {
    getMovies();
  }, []); // 최초에만 실행

  return <div>{loading ? <h1>Loading..</h1> : null}</div>;
}

export default App;
```

movie api를 불러와서 genres 부분을 li 로 보여주는 부분에서  
genres가 없는 영화가 포함되는 경우가 발생하여서  
uncaught TypeError: Cannot read properties of undefined (reading 'map')  
에러가 발생하는 경우가 발생하였다.

따라서 hasOwnProperty()함수를 이용하여 미리 genres key가 있는지 확인하고 없으면 null로 처리하는 과정이 필요하다.

1. fetch, json을 진행 후 로딩을 끝냈기 때문에 반드시 setLoading(false)를 해줘야한다.
1. then 대신에 async-await을 보편적으로 사용한다.
1. await을 감싸는 await을 만들 수 있다.
1. movies.map((movie -> map의 argument는 x, y, z 등등 마음대로 해도 된다.
1. div key={movie.id} &lt;h2&gt;{movie.title}&lt;/h2&gt; 이 컴포넌트들은 movie 배열에 있는 각 movie에서 변형되어 나온 것이다.
1. key={g} 따로 정해진 key가 없기 때문에 g를 가져와 key로 써준다. 단, g가 고유한 값일 경우에만 가능하다.
1. key를 꼭 줘야한다는 것을 기억해야한다.
